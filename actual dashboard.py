import streamlit as st 
import pandas as pd

# -----------------------
# Data from EIA (2001-2014)
# -----------------------
data = {
    "Date": [
        "Jan-01","Feb-01","Mar-01","Apr-01","May-01","Jun-01","Jul-01","Aug-01","Sep-01","Oct-01","Nov-01","Dec-01",
        "Jan-02","Feb-02","Mar-02","Apr-02","May-02","Jun-02","Jul-02","Aug-02","Sep-02","Oct-02","Nov-02","Dec-02",
        "Jan-03","Feb-03","Mar-03","Apr-03","May-03","Jun-03","Jul-03","Aug-03","Sep-03","Oct-03","Nov-03","Dec-03",
        "Jan-04","Feb-04","Mar-04","Apr-04","May-04","Jun-04","Jul-04","Aug-04","Sep-04","Oct-04","Nov-04","Dec-04",
        "Jan-05","Feb-05","Mar-05","Apr-05","May-05","Jun-05","Jul-05","Aug-05","Sep-05","Oct-05","Nov-05","Dec-05",
        "Jan-06","Feb-06","Mar-06","Apr-06","May-06","Jun-06","Jul-06","Aug-06","Sep-06","Oct-06","Nov-06","Dec-06",
        "Jan-07","Feb-07","Mar-07","Apr-07","May-07","Jun-07","Jul-07","Aug-07","Sep-07","Oct-07","Nov-07","Dec-07",
        "Jan-08","Feb-08","Mar-08","Apr-08","May-08","Jun-08","Jul-08","Aug-08","Sep-08","Oct-08","Nov-08","Dec-08",
        "Jan-09","Feb-09","Mar-09","Apr-09","May-09","Jun-09","Jul-09","Aug-09","Sep-09","Oct-09","Nov-09","Dec-09",
        "Jan-10","Feb-10","Mar-10","Apr-10","May-10","Jun-10","Jul-10","Aug-10","Sep-10","Oct-10","Nov-10","Dec-10",
        "Jan-11","Feb-11","Mar-11","Apr-11","May-11","Jun-11","Jul-11","Aug-11","Sep-11","Oct-11","Nov-11","Dec-11",
        "Jan-12","Feb-12","Mar-12","Apr-12","May-12","Jun-12","Jul-12","Aug-12","Sep-12","Oct-12","Nov-12","Dec-12",
        "Jan-13","Feb-13","Mar-13","Apr-13","May-13","Jun-13","Jul-13","Aug-13","Sep-13","Oct-13","Nov-13","Dec-13",
        "Jan-14","Feb-14","Mar-14","Apr-14","May-14","Jun-14","Jul-14","Aug-14","Sep-14","Oct-14","Nov-14","Dec-14"
    ],
    "All Sectors": [310816,272335,269298,254391,264490,290008,315798,332193,295925,267559,253034,268611,
                    290967,263728,267460,257946,269323,296470,337285,338115,310498,284178,263034,286462,
                    304263,282240,274473,256710,268788,290450,334209,341819,306590,277380,262977,293836,
                    307856,286433,278182,262851,279036,307772,333907,330927,308566,281737,270163,300050,
                    309079,279514,286791,264168,273500,319381,355514,362544,330923,297626,274585,307343,
                    304866,281046,289970,268208,287198,321840,362387,368634,317282,291186,277182,300119,
                    315104,301331,291660,275341,292800,323007,352642,373365,337525,307783,286299,307704,
                    326215,305095,294625,277963,288276,328592,360427,351856,321906,291762,278330,308916,
                    321624,286251,283808,265464,275276,305520,337878,344845,310563,287116,268158,310291,
                    331879,298460,292511,267052,283729,330893,369018,371769,327742,287840,274900,319048,
                    334116,296903,292052,275204,287993,328707,370692,372720,326247,288133,275235,301844,
                    310975,286983,283731,270760,296968,325160,370963,364785,318090,290735,278212,297288,
                    320683,291480,297226,277782,289398,320201,358701,353580,323478,294370,281494,316475,
                    341238,308941,302388,275894,291421,322792,351524,351883,326907,296680,285413,309620],
    "Residential": [127066,99878,92805,82454,81731,99407,120707,129205,105943,85420,80807,96184,
                    116892,96593,95319,85408,87319,107170,133695,134332,115833,94531,88822,109266,
                    124273,110937,99561,83448,87804,101286,130674,134468,113849,89781,86659,113084,
                    127121,112464,98947,85377,90598,112335,129305,126423,112338,93466,89650,113956,
                    125288,106667,104065,86749,87384,116627,144476,146905,126516,102686,91687,120177,
                    120419,104511,104955,89374,94000,118815,147338,150064,116072,96246,94843,114882,
                    125286,121464,105695,90282,96389,117418,139027,150101,129512,103754,95905,117408,
                    133368,118554,107162,92166,92246,121376,143179,138460,117078,96111,95766,125195,
                    136229,115212,106501,91631,94312,114395,137498,138223,115163,98552,93028,124013,
                    147500,122840,111790,88046,94843,127496,154689,154053,124583,96688,93166,130014,
                    145062,120110,104922,93702,97689,125983,154729,153739,122719,94585,93220,116341,
                    125881,107975,99362,88103,100895,122934,154579,147941,118831,96669,97155,114188,
                    131785,113114,112097,95541,95192,117982,143855,138065,121419,98893,97904,128966,
                    146511,128475,114233,92290,95727,118049,137028,135830,120741,98038,99486,120801],
    "Commercial": [90825,81467,84064,81061,87471,95658,102156,105622,96704,89378,83226,85436,
                   87429,80951,83545,83619,88974,95903,105986,105819,100809,96313,86095,89054,
                   98557,91239,92580,89685,95819,102407,115233,116224,106473,100036,92605,97870,
                   99281,93677,95331,93532,100879,108122,115495,114452,109595,102326,95753,101980,
                   100862,93257,98924,94439,99702,114101,122037,124436,116517,108474,98799,103531,
                   101933,95713,101115,96551,106442,115785,125541,127655,114231,109000,101104,104673,
                   106667,100756,102640,101051,108559,117352,123923,130475,119898,114481,104603,105909,
                   109061,104397,103335,101487,107473,119373,128072,124196,118289,110850,102415,107186,
                   109643,99011,102458,99804,105212,114832,121323,123777,114900,108514,98901,108478,
                   108121,100747,101751,99790,106172,119385,127924,129166,119137,108461,101519,108026,
                   108251,99796,104257,100506,107625,118170,128065,129368,117951,108650,100552,104866,
                   105239,100080,102474,101037,110800,118009,128535,128106,116585,110471,101641,104122,
                   107729,101016,104011,101395,108683,117410,127311,127063,118408,111907,103384,108762,
                   113866,104353,106968,102459,109666,118423,125434,125603,120049,113023,104245,108070],
    "Industrial": [83477,82248,83522,82253,86097,85269,83176,86797,82631,83145,79914,78081,
                   78240,78059,80461,80750,84460,84387,88123,88265,84346,83984,79706,79456,
                   80828,79517,81758,83058,84619,86210,87732,90536,85682,86982,83164,82288,
                   80823,79668,83328,83369,86988,86732,88479,89440,86019,85346,84191,83467,
                   82242,78935,83185,82389,85852,88033,88386,90536,87256,85856,83512,82974,
                   81865,80207,83264,81696,86179,86630,88880,90285,86364,85337,80653,79937,
                   82384,78392,82582,83361,87241,87572,89017,92115,87428,88896,85118,83725,
                   83091,81484,83498,83696,87963,87224,88527,88552,85910,84164,79539,75869,
                   74983,71358,74171,73415,75151,75681,78391,82199,79863,79451,75639,77115,
                   75549,74191,78319,78620,82114,83360,85744,87927,83390,82081,79614,80313,
                   80093,76361,82209,80367,82061,83912,87247,88987,84943,84282,80872,79982,
                   79205,78298,81298,81030,84678,83619,87219,88105,82060,82996,78847,78360,
                   80505,76692,80474,80216,84897,84170,86887,87806,83025,82980,79632,78067,
                   80149,75413,80539,80505,85383,85711,88417,89808,85489,84994,81044,80123],
    "Transportation": [None,None,None,None,None,None,None,None,None,None,None,None,
                       None,None,None,None,None,None,None,None,None,None,None,None,
                       604,547,574,519,546,547,570,591,586,581,549,595,
                       631,624,576,573,570,583,627,610,614,599,570,647,687,
                       655,618,590,562,620,615,667,635,610,587,660,649,615,636,
                       587,577,609,627,630,615,602,582,627,766,719,743,646,611,665,
                       675,673,687,652,673,663,694,660,630,614,594,620,649,649,
                       629,637,611,666,769,671,677,613,601,613,666,647,636,600,590,
                       685,709,682,651,595,600,653,661,622,633,610,601,694,710,637,
                       664,629,619,643,650,625,634,616,590,656,650,629,597,590,595,597,
                       629,633,613,599,569,619,664,659,644,630,627,638,649,645,626,591,
                       574,679,712,700,648,640,646,609,645,642,628,625,637,626],
    "Other": [9448,8742,8908,8624,9192,9674,9759,10568,10646,9617,9087,8910,
              8407,8125,8135,8169,8571,9010,9481,9698,9510,9350,8410,8686,
              None,None,None,None,None,None,None,None,None,None,None,None,
              None,None,None,None,None,None,None,None,None,None,None,None,
              None,None,None,None,None,None,None,None,None,None,None,None,
              None,None,None,None,None,None,None,None,None,None,None,None,
              None,None,None,None,None,None,None,None,None,None,None,None
    ]
}

# -----------------------
# Pad shorter lists with None
# -----------------------
max_len = max(len(v) for v in data.values())
for key in data:
    if len(data[key]) < max_len:
        data[key] = data[key] + [None]*(max_len - len(data[key]))

# -----------------------
# Create DataFrame
# -----------------------
df = pd.DataFrame(data)

# -----------------------
# Streamlit dashboard
# -----------------------
st.title("Retail Electricity Sales Dashboard (US, 2001-2014)")

st.write("### Full Data")
st.dataframe(df)

# Top 5 months with biggest increases (All Sectors)
df["Change"] = df["All Sectors"].diff()
biggest_changes = df.nlargest(5, "Change")[["Date","Change"]]
st.write("### Top 5 Monthly Increases (All Sectors)")
st.dataframe(biggest_changes)

# Plot electricity sales for all sectors
st.write("### Electricity Sales by Sector Over Time")
st.line_chart(df.set_index("Date")[["All Sectors","Residential","Commercial","Industrial","Transportation","Other"]])
